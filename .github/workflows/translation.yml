# Workflow name
name: translations
on:
    push:
        branches-ignore:
            - 'dependabot/**' # ðŸ‘ˆ Excludes dependabot branches
            - 'main' # only run for non-main branches
jobs:
    translate-files:
        name: Translate localization files
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            # - uses: actions/setup-node@v2
            #   with:
            #       node-version: '14'
            #       cache: 'npm'
            #       registry-url: 'https://registry.npmjs.org'

            - name: Install localization package
              run: npm install -g i18n-auto-translation

            - name: Translate files
              id: translate
              uses: msnyder-msft/i18n-auto-translation-action@v1.0.0-alpha.5
              with:
                  provider: 'azure-official'
                  subscriptionKey: 'c75991581d0943b6a9215f31d474badd'
                  location: 'westus2'
                  filePath: './src/Resources/Locales/en/translation.json'
                  from: 'en'
                  to: 'de'
                  debug: true

            - name: Commit changes
              uses: devops-infra/action-commit-push@master
              with:
                  github_token: '${{ secrets.GITHUB_TOKEN }}'
                  commit_prefix: '[Update Translations]'
                  commit_message: 'Adding updated localization files'
                  force: false
                  target_branch: ${GITHUB_REF_NAME}
    # translate-files:
    #     name: translate-localization-files
    #     runs-on: ubuntu-latest
    #     steps:
    #         - name: Checkout
    #           uses: actions/checkout@v1

    #         # - name: Setup Node.js
    #         #   uses: actions/setup-node@v2
    #         #   with:
    #         #       node-version: '14'
    #         #       cache: 'npm'
    #         #       registry-url: 'https://registry.npmjs.org'
    #         - name: Commit changes
    #           uses: devops-infra/action-commit-push@master
    #           with:
    #               github_token: '${{ secrets.GITHUB_TOKEN }}'
    #               commit_prefix: '[Update Translations]'
    #               commit_message: 'Updating updated localization files from main'
    #               force: false
    #               target_branch: localization/updates
    #         - name: Create pull request
    #           uses: devops-infra/action-pull-request@v0.4.2
    #           with:
    #               github_token: ${{ secrets.GITHUB_TOKEN }}
    #               source_branch: localization/updates
    #               target_branch: main
    #               title: '[Auto] Update Translations'
    #               template: .github/PULL_REQUEST_TEMPLATE.md
    #               body: '**Automated pull request**'
    #               # reviewer: octocat
    #               # assignee: octocat
    #               label: enhancement
    #               get_diff: true
    #               ignore_users: 'dependabot'
    # # - name: Install dependencies
    # #   run: npm install

    # # - name: Build library
    # #   run: npm run build
    # # - name: Release
    # #   env:
    # #       GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    # #       NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
    # #   run: npx semantic-release
